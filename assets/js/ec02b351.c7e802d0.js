"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8652],{12236:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var t=n(17624),s=n(95788);const i={title:"Clustering"},o=void 0,l={id:"usage/clustering",title:"Clustering",description:"Configure a cluster",source:"@site/versioned_docs/version-v3/usage/clustering.md",sourceDirName:"usage",slug:"/usage/clustering",permalink:"/docs/v3/usage/clustering",draft:!1,unlisted:!1,editUrl:"https://github.com/distribworks/dkron/tree/main/website/docs/versioned_docs/version-v3/usage/clustering.md",tags:[],version:"v3",frontMatter:{title:"Clustering"},sidebar:"tutorialSidebar",previous:{title:"Cloud Auto-join",permalink:"/docs/v3/usage/cloud-auto-join"},next:{title:"Concurrency",permalink:"/docs/v3/usage/concurrency"}},c={},d=[{value:"Configure a cluster",id:"configure-a-cluster",level:2},{value:"Deployment Table",id:"deployment-table",level:2}];function a(e){const r={code:"code",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.MN)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h2,{id:"configure-a-cluster",children:"Configure a cluster"}),"\n",(0,t.jsx)(r.p,{children:"Dkron can run in HA mode, avoiding SPOFs, this mode provides better scalability and better reliability for users that wants a high level of confidence in the cron jobs they need to run."}),"\n",(0,t.jsx)(r.p,{children:"Manually bootstrapping a Dkron cluster does not rely on additional tooling, but does require operator participation in the cluster formation process. When bootstrapping, Dkron servers and clients must be started and informed with the address of at least one Dkron server."}),"\n",(0,t.jsx)(r.p,{children:"As you can tell, this creates a chicken-and-egg problem where one server must first be fully bootstrapped and configured before the remaining servers and clients can join the cluster. This requirement can add additional provisioning time as well as ordered dependencies during provisioning."}),"\n",(0,t.jsx)(r.p,{children:"First, we bootstrap a single Dkron server and capture its IP address. After we have that nodes IP address, we place this address in the configuration."}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsx)(r.li,{children:"First bootstrap a node with a configuration like this:"}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"# dkron.yml\nserver: true\nbootstrap-expect: 1\n"})}),"\n",(0,t.jsxs)(r.ol,{start:"2",children:["\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"Then stop the bootstrapped server and capture the server IP address."}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["\n",(0,t.jsx)(r.p,{children:"To form a cluster, configure server nodes (including the bootstrapped server) with the address of its peers as in the following example:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",children:"# dkron.yml\nserver: true\nbootstrap-expect: 3\nretry-join:\n- 10.19.3.9\n- 10.19.4.64\n- 10.19.7.215\n"})}),"\n",(0,t.jsx)(r.h2,{id:"deployment-table",children:"Deployment Table"}),"\n",(0,t.jsxs)(r.p,{children:["Below is a table that shows quorum size and failure tolerance for various\ncluster sizes. The recommended deployment is either 3 or 5 servers. A single\nserver deployment is ",(0,t.jsx)(r.em,{children:(0,t.jsx)(r.strong,{children:"highly"})})," discouraged as data loss is inevitable in a\nfailure scenario."]}),"\n",(0,t.jsxs)("table",{children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Servers"}),(0,t.jsx)("th",{children:"Quorum Size"}),(0,t.jsx)("th",{children:"Failure Tolerance"})]})}),(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"1"}),(0,t.jsx)("td",{children:"1"}),(0,t.jsx)("td",{children:"0"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"2"}),(0,t.jsx)("td",{children:"2"}),(0,t.jsx)("td",{children:"0"})]}),(0,t.jsxs)("tr",{class:"warning",children:[(0,t.jsx)("td",{children:"3"}),(0,t.jsx)("td",{children:"2"}),(0,t.jsx)("td",{children:"1"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"4"}),(0,t.jsx)("td",{children:"3"}),(0,t.jsx)("td",{children:"1"})]}),(0,t.jsxs)("tr",{class:"warning",children:[(0,t.jsx)("td",{children:"5"}),(0,t.jsx)("td",{children:"3"}),(0,t.jsx)("td",{children:"2"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"6"}),(0,t.jsx)("td",{children:"4"}),(0,t.jsx)("td",{children:"2"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"7"}),(0,t.jsx)("td",{children:"4"}),(0,t.jsx)("td",{children:"3"})]})]})]})]})}function u(e={}){const{wrapper:r}={...(0,s.MN)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},95788:(e,r,n)=>{n.d(r,{MN:()=>d});var t=n(11504);function s(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function i(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function o(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?i(Object(n),!0).forEach((function(r){s(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function l(e,r){if(null==e)return{};var n,t,s=function(e,r){if(null==e)return{};var n,t,s={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||(s[n]=e[n]);return s}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var c=t.createContext({}),d=function(e){var r=t.useContext(c),n=r;return e&&(n="function"==typeof e?e(r):o(o({},r),e)),n},a={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},u=t.forwardRef((function(e,r){var n=e.components,s=e.mdxType,i=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),h=d(n),p=s,j=h["".concat(c,".").concat(p)]||h[p]||a[p]||i;return n?t.createElement(j,o(o({ref:r},u),{},{components:n})):t.createElement(j,o({ref:r},u))}));u.displayName="MDXCreateElement"}}]);